# ğŸš€ Render.com Deployment Rehberi

Bu rehber, **aslaw-backend** projesini Render.com'da nasÄ±l deploy edeceÄŸinizi gÃ¶sterir.

## ğŸ“‹ Ã–n HazÄ±rlÄ±k

### 1. GitHub Token OluÅŸturma
GitHub Packages'dan `infra-core` dependency'sini Ã§ekebilmek iÃ§in:

1. GitHub â†’ Settings â†’ Developer settings â†’ Personal access tokens â†’ Tokens (classic)
2. **Generate new token (classic)**
3. Scope'lar:
   - âœ… `read:packages` (GitHub Packages okuma)
   - âœ… `repo` (private repository eriÅŸimi)
4. Token'Ä± kopyalayÄ±n (Ã¶rn: `ghp_xxxxxxxxxxxx`)

### 2. Gerekli Dosyalar
Projenizde ÅŸu dosyalar bulunmalÄ±:
- âœ… `render.yaml` - Render konfigÃ¼rasyonu
- âœ… `Dockerfile.render` - Optimize edilmiÅŸ Dockerfile
- âœ… `application-prod.yml` - Production ayarlarÄ±

## ğŸ”§ Render.com'da Deployment

### AdÄ±m 1: Render HesabÄ± OluÅŸturma
1. [render.com](https://render.com) â†’ Sign up with GitHub
2. GitHub hesabÄ±nÄ±zla giriÅŸ yapÄ±n

### AdÄ±m 2: Yeni Service OluÅŸturma
1. Render Dashboard â†’ **New +** â†’ **Blueprint**
2. **Connect a repository** â†’ `aslaw` projesini seÃ§in
3. **Blueprint Name**: `aslaw-backend`
4. **Branch**: `main`

### AdÄ±m 3: Environment Variables Ekleme
Render Dashboard'da service'inizi seÃ§in â†’ **Environment** sekmesi:

```bash
# GitHub Authentication (ZORUNLU)
GITHUB_USERNAME=fthgcr
GITHUB_TOKEN=ghp_xxxxxxxxxxxx  # YukarÄ±da oluÅŸturduÄŸunuz token

# Spring Profile
SPRING_PROFILES_ACTIVE=prod

# Database (Otomatik oluÅŸturulacak)
SPRING_DATASOURCE_URL=<render-db-url>
SPRING_DATASOURCE_USERNAME=<render-db-user>
SPRING_DATASOURCE_PASSWORD=<render-db-password>

# JWT Secret (Render otomatik oluÅŸturacak)
JWT_SECRET=<auto-generated>

# File Upload
UPLOAD_PROVIDER=local
UPLOAD_DIR=/app/uploads
```

### AdÄ±m 4: Database Kurulumu
1. Render Dashboard â†’ **New +** â†’ **PostgreSQL**
2. **Name**: `aslaw-db`
3. **Database Name**: `aslaw`
4. **User**: `aslaw_user`
5. **Plan**: Free
6. **Region**: Frankfurt

### AdÄ±m 5: Service BaÄŸlantÄ±sÄ±
1. Web Service â†’ **Environment** â†’ **Add Environment Variable**
2. Database connection string'leri ekleyin:
   ```
   SPRING_DATASOURCE_URL=postgresql://...
   SPRING_DATASOURCE_USERNAME=aslaw_user
   SPRING_DATASOURCE_PASSWORD=...
   ```

## ğŸ“ Dockerfile SeÃ§imi

Render.com iÃ§in `Dockerfile.render` kullanÄ±n:

```dockerfile
# render.yaml dosyasÄ±nda
services:
  - type: web
    dockerfilePath: ./Dockerfile.render
```

## ğŸ” Deployment KontrolÃ¼

### Health Check
- URL: `https://your-app.onrender.com/actuator/health`
- Beklenen yanÄ±t: `{"status":"UP"}`

### API Documentation
- Swagger UI: `https://your-app.onrender.com/swagger-ui.html`
- API Docs: `https://your-app.onrender.com/api-docs`

## ğŸš¨ YaygÄ±n Sorunlar ve Ã‡Ã¶zÃ¼mler

### 1. GitHub Packages 401 HatasÄ±
**Sorun**: `infra-core` dependency Ã§ekilemiyor
**Ã‡Ã¶zÃ¼m**: 
- `GITHUB_TOKEN` environment variable'Ä±nÄ± kontrol edin
- Token'Ä±n `read:packages` yetkisine sahip olduÄŸundan emin olun

### 2. Database Connection HatasÄ±
**Sorun**: PostgreSQL baÄŸlantÄ± hatasÄ±
**Ã‡Ã¶zÃ¼m**:
- Database'in aynÄ± region'da olduÄŸundan emin olun
- Connection string'in doÄŸru formatda olduÄŸunu kontrol edin

### 3. Build Timeout
**Sorun**: Maven build Ã§ok uzun sÃ¼rÃ¼yor
**Ã‡Ã¶zÃ¼m**:
- Render'da build timeout'u artÄ±rÄ±n
- Multi-stage Dockerfile kullanÄ±n (zaten kullanÄ±lÄ±yor)

### 4. Memory HatasÄ±
**Sorun**: Container memory limit aÅŸÄ±lÄ±yor
**Ã‡Ã¶zÃ¼m**:
- JVM heap size'Ä± ayarlayÄ±n: `-Xmx512m`
- Render'da plan upgrade yapÄ±n

## ğŸ”§ Render.yaml KonfigÃ¼rasyonu

```yaml
services:
  - type: web
    name: aslaw-backend
    env: docker
    dockerfilePath: ./Dockerfile.render
    plan: free
    region: frankfurt
    branch: main
    buildCommand: ""
    startCommand: ""
    healthCheckPath: /actuator/health
    envVars:
      - key: GITHUB_USERNAME
        value: fthgcr
      - key: GITHUB_TOKEN
        sync: false
      - key: SPRING_PROFILES_ACTIVE
        value: prod
      # ... diÄŸer env vars

databases:
  - name: aslaw-db
    databaseName: aslaw
    user: aslaw_user
    plan: free
    region: frankfurt
```

## ğŸ“Š Monitoring

### Logs
- Render Dashboard â†’ Service â†’ **Logs**
- Real-time log streaming

### Metrics
- Render Dashboard â†’ Service â†’ **Metrics**
- CPU, Memory, Network kullanÄ±mÄ±

### Alerts
- Render Dashboard â†’ Service â†’ **Settings** â†’ **Alerts**
- Deploy failure, service down alerts

## ğŸ¯ Production Checklist

- [ ] GitHub token oluÅŸturuldu ve eklendi
- [ ] Database oluÅŸturuldu ve baÄŸlandÄ±
- [ ] Environment variables eklendi
- [ ] Health check Ã§alÄ±ÅŸÄ±yor
- [ ] API documentation eriÅŸilebilir
- [ ] SSL certificate aktif (Render otomatik)
- [ ] Custom domain eklendi (opsiyonel)

## ğŸ†˜ Destek

Sorun yaÅŸarsanÄ±z:
1. Render Dashboard â†’ **Logs** kontrol edin
2. GitHub Issues'da sorun bildirin
3. Render Community'de yardÄ±m isteyin

---

âœ… **BaÅŸarÄ±lÄ± deployment sonrasÄ±:**
- API Base URL: `https://your-app.onrender.com`
- Health Check: `https://your-app.onrender.com/actuator/health`
- Swagger UI: `https://your-app.onrender.com/swagger-ui.html` 